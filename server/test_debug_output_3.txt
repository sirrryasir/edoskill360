$ jest
  console.log
    Test JobID: 6966452df5ad38ea385f144c

      at Object.<anonymous> (tests/application.test.ts:55:21)

  console.log
    Apply Body: {
      jobId: '6966452df5ad38ea385f144c',
      coverLetter: 'Hire me',
      resumeLink: 'http://resume.com'
    }

      at applyForJob (src/controllers/applicationController.ts:10:17)

  console.log
    Apply User: {
      verificationStatus: {
        identity: 'unverified',
        skills: 'unverified',
        experience: 'unverified',
        references: 'unverified'
      },
      _id: new ObjectId('6966452df5ad38ea385f1448'),
      name: 'App Talent',
      email: 'work1@test.com',
      role: 'talent',
      trustScore: 0,
      verificationStage: 'UNVERIFIED',
      createdAt: 2026-01-13T13:14:21.110Z,
      updatedAt: 2026-01-13T13:14:21.110Z,
      __v: 0
    }

      at applyForJob (src/controllers/applicationController.ts:11:17)

  console.log
    Apply Error: {
      "message": "Application validation failed: jobId: Path `jobId` is required."
    }

      at Object.<anonymous> (tests/application.test.ts:66:54)

PASS tests/agent.test.ts (17.857 s)
  Agent Endpoints
    âœ“ should allow agent to view and approve verification requests (636 ms)

  console.log
    [SIMULATION] ðŸ“§ Sending verification request to boss@corp.com (WhatsApp/Email)...

      at requestReferenceVerification (src/controllers/verificationController.ts:128:17)

  console.log
    [SIMULATION] âœ… Message sent! Now waiting for Agent Approval.

      at requestReferenceVerification (src/controllers/verificationController.ts:129:17)

PASS tests/job.test.ts (17.866 s)
  Job Endpoints
    Job Workflow
      âœ“ should allow employer to create a job and verify it exists (392 ms)
      âœ“ should prevent talents from creating jobs (177 ms)

FAIL tests/application.test.ts (18.179 s)
  Job Application Endpoints
    Application Flow
      âœ• should allow talent to apply for a job and employer to view it (675 ms)

  â— Job Application Endpoints â€º Application Flow â€º should allow talent to apply for a job and employer to view it

    expect(received).toEqual(expected) // deep equality

    Expected: 201
    Received: 500

      65 |                 });
      66 |             if (applyRes.statusCode !== 201) console.log('Apply Error:', JSON.stringify(applyRes.body, null, 2));
    > 67 |             expect(applyRes.statusCode).toEqual(201);
         |                                         ^
      68 |             expect(applyRes.body.status).toEqual('pending');
      69 |
      70 |             // 4. Verify duplicate application fails

      at Object.<anonymous> (tests/application.test.ts:67:41)

PASS tests/verification.test.ts (18.375 s)
  Verification Endpoints
    âœ“ should handle identity verification flow (631 ms)
    âœ“ should handle reference verification request (209 ms)

PASS tests/auth.test.ts (18.38 s)
  Auth Endpoints
    POST /api/auth/register
      âœ“ should register a new user successfully (543 ms)
      âœ“ should return 400 if user already exists (189 ms)
    POST /api/auth/login
      âœ“ should login successfully with correct credentials (234 ms)
      âœ“ should fail with incorrect password (232 ms)

PASS tests/user.test.ts (18.458 s)
  User Endpoints
    GET /api/users/profile
      âœ“ should return the logged in user profile (572 ms)
      âœ“ should fail without auth token (121 ms)
    PUT /api/users/profile
      âœ“ should update user profile fields (137 ms)
      âœ“ should not update restricted fields directly if prevented (checking role) (179 ms)
    GET /api/users/:id
      âœ“ should get public user profile without auth (178 ms)

Test Suites: 1 failed, 5 passed, 6 total
Tests:       1 failed, 14 passed, 15 total
Snapshots:   0 total
Time:        20.1 s
Ran all test suites.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
error: script "test" exited with code 1
